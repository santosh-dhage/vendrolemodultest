"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6075],{36075:(e,s,a)=>{a.r(s),a.d(s,{default:()=>g});var l=a(9950),t=a(1072),i=a(28429),r=a(37017),n=a(42074),d=a(45532),c=a(79988),o=a(7864),u=a(27760),h=a(84257),m=a(44885),p=a(44414);const g=function(){(0,i.Zp)();let e=(0,t.A)();const{user:s,authTokens:a}=(0,l.useContext)(d.A);let[g,_]=(0,l.useState)([]),[x,b]=(0,l.useState)([]),[v,j]=(0,l.useState)([]),[f,y]=(0,l.useState)([]),[S,C]=(0,l.useState)([]),[w,k]=(0,l.useState)([]);const{selectedColor:M}=(0,m.useColor)();let[F,N]=(0,l.useState)();const[D,A]=(0,l.useState)(!1),[P,U]=(0,l.useState)(!1),[T,O]=(0,l.useState)(!1),[I,K]=(0,l.useState)(!1),[L,V]=(0,l.useState)(!1);let[q,z]=(0,l.useState)([]),[E,Z]=(0,l.useState)([]);(0,l.useEffect)((()=>{Q()}),[]);let Q=async()=>{let s=await e.get("/machine/api/get_unused_machine_map/"),a=await e.get("/machine/api/machine_user_mapping_by_admin_user/"),l=await e.get("/api/get_user_list/");if(1===s.data.success&&1===l.data.success){let e=[];for(let a=0;a<s.data.result.length;a++){let l=s.data.result[a],t={value:l.id,label:l.machine_id};e.push(t)}let d=[];for(let s=0;s<l.data.result.length;s++){let e=l.data.result[s];if(1==e.is_active){let s={value:e.id,label:e.email};d.push(s)}}let c=[{value:"",label:""}];for(let a=0;a<s.data.result.length;a++){let e=s.data.result[a],l={value:e.id,label:e.machine_id};c.push(l)}let o=[{value:"",label:""}];for(let s=0;s<l.data.result.length;s++){let e=l.data.result[s];if(1==e.is_active){let s={value:e.id,label:e.email};o.push(s)}}let u=[];for(let s=0;s<a.data.result.length;s++){var t,i,r,n;let e=a.data.result[s],l={id:e.id,assigned_user:null===e||void 0===e||null===(t=e.assigned_user)||void 0===t?void 0:t.email,assigned_user_id:null===e||void 0===e||null===(i=e.assigned_user)||void 0===i?void 0:i.id,machine_id_id:null===e||void 0===e||null===(r=e.machine_id)||void 0===r?void 0:r.id,machine_id:null===e||void 0===e||null===(n=e.machine)||void 0===n?void 0:n.machine_id,assigned_user_date:null===e||void 0===e?void 0:e.assigned_user_date};u.push(l)}_(e),y(d),j(u),C(o),k(c)}else if(0===s.data.success)for(let e=0;e<Object.values(s.data.result).length;e++){let a=Object.values(s.data.result)[e];alert(a)}};const W=async e=>{let s=[];null===f||void 0===f||f.map((a=>{a.value==e.assigned_user_id&&s.push(a)})),null===f||void 0===f||f.map((a=>{a.value!=e.assigned_user_id&&s.push(a)})),z(s);let a=[];null===g||void 0===g||g.map((s=>{s.value==e.machine_id_id&&a.push(s)})),null===g||void 0===g||g.map((s=>{s.value!=e.machine_id_id&&a.push(s)})),Z(a)},B=e=>{const s=new Date(e),a=String(s.getDate()).padStart(2,"0"),l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()],t=s.getFullYear(),i=String(s.getHours()).padStart(2,"0"),r=String(s.getMinutes()).padStart(2,"0");return"".concat(a," - ").concat(l," - ").concat(t," ").concat(i,":").concat(r)};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,p.jsx)("h3",{className:"mb-0",style:{color:"#2C384A"},children:"Machine User Mapping"}),(0,p.jsx)(r.Q_,{onClick:()=>{U(!P)},className:"mt-2",style:{backgroundColor:M,color:"white"},children:"Map Machine"})]}),(0,p.jsx)(r.sK,{children:(0,p.jsx)(r.UF,{xs:12,children:(0,p.jsx)(r.Pd,{activePage:1,clickableRows:!0,columns:[{key:"sr_no",label:"Sr. No.",sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"60px"}},{label:"Assigned User",key:"assigned_user",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"150px"},sorter:!1},{label:"Assigned Machine ID",key:"machine_id",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"160px"},sorter:!1},{label:"Assigned Date",key:"assigned_user_date",_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"120px"},sorter:!1},{key:"Action",label:"Action",filter:!1,sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"60px"}}],columnSorter:!0,items:v,itemsPerPageSelect:!0,itemsPerPage:10,pagination:!0,scopedColumns:{Action:e=>(0,p.jsxs)("td",{children:[(0,p.jsx)(n.N_,{to:"#",children:(0,p.jsx)(o.A,{icon:u.K,style:{color:"blue"},size:"md",title:"Edit",onClick:()=>[N(e),A(e.id),W(e),O(!T)]})}),"\xa0\xa0\xa0",(0,p.jsx)(n.N_,{to:"/machineuserview/"+"".concat(e.id),children:(0,p.jsx)(r.t7,{src:c,width:17,height:15,title:"View Details"})})," \xa0\xa0\xa0"]}),sr_no:(e,s)=>(0,p.jsx)("td",{children:s+1}),assigned_user_date:e=>(0,p.jsx)("td",{children:B(e.assigned_user_date)})},itemsPerPageOptions:[10,20,50,100],tableFilter:!0,tableProps:{color:"success-color-secondary",hover:!0,border:"1.5px solid #074",responsive:!0},tableHeadProps:{color:"light",align:"middle",className:"align-middle"},tableBodyProps:{align:"middle",className:"align-middle"},tableFilterLabel:"Search : ",tableFilterPlaceholder:"Enter String to Search",itemsPerPageLabel:"Rows per page:"})})})]}),(0,p.jsxs)(r.zS,{size:"lg",visible:P,onClose:()=>[U(!1),K(!1),V(!1)],backdrop:"static",children:[(0,p.jsx)(r.E4,{onClose:()=>[U(!1),K(!1),V(!1)],style:{backgroundColor:M,color:"white"},children:(0,p.jsx)(r.lb,{children:"Add  User Mapping"})}),(0,p.jsxs)(r.qI,{className:"row g-3 needs-validation",style:{margin:"10px"},noValidate:!0,validated:I,onSubmit:async s=>{const a=s.currentTarget;if(s.preventDefault(),!0===a.checkValidity()){const a=new FormData(s.target),l=(new Date).toISOString();a.append("assigned_user_date",l);let t=await e.post("/machine/machine-user-mapping/",a);if(1===t.data.success)alert("User is mapped to Machine Id"),K(!1),U(!1),Q(),window.location.reload();else if(0===t.data.success)for(let e=0;e<Object.values(t.data.result).length;e++){let s=Object.values(t.data.result)[e];alert(s)}}else K(!0)},children:[(0,p.jsx)(r.Tc,{children:(0,p.jsx)(r.sK,{sm:12,className:"",children:(0,p.jsxs)(r.sK,{children:[(0,p.jsxs)(r.UF,{sm:6,children:[(0,p.jsxs)(r.A6,{htmlFor:"validationDefault01",children:["Map User",(0,p.jsx)("span",{className:"text-danger",children:"*"})]}),(0,p.jsx)(r.MT,{name:"assigned_user",options:S,required:!0}),(0,p.jsx)(r.To,{invalid:!0,children:"Please select User"})]}),(0,p.jsxs)(r.UF,{sm:6,children:[(0,p.jsxs)(r.A6,{htmlFor:"validationDefault01",children:["Map Machine",(0,p.jsx)("span",{className:"text-danger",children:"*"})]}),(0,p.jsx)(r.MT,{name:"machine",options:w,required:!0}),(0,p.jsx)(r.To,{invalid:!0,children:"Please select Machine id"})]})]})})}),(0,p.jsxs)(r.If,{children:[(0,p.jsx)(r.Q_,{onClick:()=>[U(!1),K(!1),V(!1)],style:{backgroundColor:"#F5F5F5",color:"black",borderColor:"#DCDCDC"},children:"\xa0Close\xa0"}),(0,p.jsxs)(r.Q_,{type:"submit",style:{backgroundColor:M,color:"white"},disabled:L,children:["\xa0 ","Submit"]})]})]})]}),(0,p.jsxs)(r.zS,{size:"lg",visible:T,onClose:()=>[O(!1),K(!1),V(!1)],backdrop:"static",children:[(0,p.jsx)(r.E4,{onClose:()=>[O(!1),K(!1),V(!1)],style:{backgroundColor:M,color:"white"},children:(0,p.jsx)(r.lb,{children:"Edit User Mapping"})}),(0,p.jsxs)(r.qI,{className:"row g-3 needs-validation",style:{margin:"10px"},noValidate:!0,validated:I,onSubmit:async s=>{const a=s.currentTarget;if(s.preventDefault(),!0===a.checkValidity()){const a=new FormData(s.target);let l=await e.patch("/machine/machine-user-mapping/".concat(D,"/"),a);if(1===l.data.success)alert("Member is updated"),K(!1),O(!1),Q();else if(0===l.data.success)for(let e=0;e<Object.values(l.data.result).length;e++){let s=Object.values(l.data.result)[e];alert(s)}}K(!0)},children:[(0,p.jsx)(r.Tc,{children:(0,p.jsx)(r.sK,{sm:12,className:"",children:(0,p.jsxs)(r.sK,{children:[(0,p.jsxs)(r.UF,{sm:6,children:[(0,p.jsxs)(r.A6,{htmlFor:"validationDefault01",children:["Map User",(0,p.jsx)("span",{className:"text-danger",children:"*"})]}),(0,p.jsx)(r.MT,{name:"assigned_user",options:q,defaultValue:null===F||void 0===F?void 0:F.assigned_user,required:!0}),(0,p.jsx)(r.To,{invalid:!0,children:"Please select User"})]}),(0,p.jsxs)(r.UF,{sm:6,children:[(0,p.jsxs)(r.A6,{htmlFor:"validationDefault01",children:["Map Machine",(0,p.jsx)("span",{className:"text-danger",children:"*"})]}),(0,p.jsx)(r.OG,{type:"text",id:"name",name:"machine",defaultValue:null===F||void 0===F?void 0:F.machine_id,required:!0,disabled:!0}),(0,p.jsx)(r.To,{invalid:!0,children:"Please select Machine id"})]})]})})}),(0,p.jsxs)(r.If,{children:[(0,p.jsx)(r.Q_,{onClick:()=>[O(!1),K(!1),V(!1)],style:{backgroundColor:"#F5F5F5",color:"black",borderColor:"#DCDCDC"},children:"\xa0Close\xa0"}),(0,p.jsxs)(r.Q_,{type:"submit",style:{backgroundColor:M,color:"white"},children:[(0,p.jsx)(o.A,{icon:h.B,style:{color:"white"},size:"sm"}),"\xa0Submit"]})]})]})]})]})}},84257:(e,s,a)=>{a.d(s,{B:()=>l});const l=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M199.066,456l-7.379-7.514-3.94-3.9-86.2-86.2.053-.055L17.936,274.665l97.614-97.613,83.565,83.565L398.388,61.344,496,158.958,296.729,358.229,285.469,369.6ZM146.6,358.183l52.459,52.46.1-.1.054.054,52.311-52.311,11.259-11.368L450.746,158.958,398.388,106.6,199.115,305.871,115.55,222.306,63.191,274.665l83.464,83.463Z' class='ci-primary'/>"]},27760:(e,s,a)=>{a.d(s,{K:()=>l});const l=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M29.663,482.25l.087.087a24.847,24.847,0,0,0,17.612,7.342,25.178,25.178,0,0,0,8.1-1.345l142.006-48.172,272.5-272.5A88.832,88.832,0,0,0,344.334,42.039l-272.5,272.5L23.666,456.541A24.844,24.844,0,0,0,29.663,482.25Zm337.3-417.584a56.832,56.832,0,0,1,80.371,80.373L411.5,180.873,331.127,100.5ZM99.744,331.884,308.5,123.127,388.873,203.5,180.116,412.256,58.482,453.518Z' class='ci-primary'/>"]}}]);