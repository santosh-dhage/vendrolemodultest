"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[8510],{65361:(e,t,a)=>{a(9950),a(84494),a(44414)},88510:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var n=a(9950),s=a(1072),l=a(37017),o=a(45532),r=a(7864),i=a(76058),c=(a(46411),a(55271),a(65361),a(59019),a(60764),a(4434),a(44885)),d=a(74297),h=a(95652),m=a(44414);const u=(0,d.A)();const g=function(){let e=(0,s.A)();const t=(0,h.A)(),{user:a,authTokens:d}=(0,n.useContext)(o.A);let[g,p]=(0,n.useState)([]),[w,y]=(0,n.useState)(f(new Date((new Date).setDate((new Date).getDate()-1)))),[x,_]=(0,n.useState)(f(new Date((new Date).setDate((new Date).getDate()))));const{selectedColor:D}=(0,c.useColor)();(0,n.useEffect)((()=>{j()}),[]);const b=e=>{if(null==e)return"          ";const t=new Date(e),a=String(t.getDate()).padStart(2,"0"),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],s=t.getFullYear(),l=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return"".concat(a," - ").concat(n," - ").concat(s," ").concat(l,":").concat(o)};function f(e){if(null!=e){var t=new Date(e),a=""+(t.getMonth()+1),n=""+t.getDate(),s=t.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[s,a,n].join("-")}}const j=async t=>{var a=document.getElementById("datetodate1").selectedIndex;var n=document.getElementById("datetodate1").options[a].value;y(n.split("=")[0]),_(n.split("=")[1]);let s=await e.post("machine/api/read_machine_user_mapping_report_excel/",{from:f(n.split("=")[0]),to:f(n.split("=")[1])});if(1===s.data.success){let e=[];for(let t=0;t<s.data.result.length;t++){let a=s.data.result[t];console.log(a);let n={user_name:a.name,user_Id:a.email,mobile_no:a.mobile_no,machine_id:a.machine_id,machine_assigned_date:b(a.user_assigned_date)};e.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),e.push(n)}p([]),p(e)}else 0===s.data.success&&(p([]),alert(s.data.message))},v={today:f(new Date)+"="+f(new Date),yesterday:f(new Date((new Date).setDate((new Date).getDate()-1)))+"="+f(new Date((new Date).setDate((new Date).getDate()-1))),week:f(new Date((new Date).setDate((new Date).getDate()-6)))+"="+f(new Date(new Date)),month:f(new Date((new Date).setDate((new Date).getDate()-29)))+"="+f(new Date(new Date)),quarterly:f(new Date((new Date).setDate((new Date).getDate()-90)))+"="+f(new Date(new Date)),yearly:f(new Date((new Date).setDate((new Date).getDate()-365)))+"="+f(new Date(new Date))};return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"mb-3",children:[(0,m.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,m.jsx)("div",{children:(0,m.jsx)("h3",{className:"mb-0",style:{color:"#2C384A"},children:"User Machine Report"})})," ",(0,m.jsx)("div",{children:" "})]}),(0,m.jsxs)("div",{className:"input-group mt-2 mb-2",children:[(0,m.jsx)("div",{children:(0,m.jsxs)("select",{id:"datetodate1",onChange:j,style:{width:"150px",height:"25px"},children:[(0,m.jsxs)("option",{value:v.today,children:[" ","\xa0\xa0  \xa0 \xa0\xa0 Today \xa0 \xa0\xa0"," "]}),(0,m.jsxs)("option",{value:v.yesterday,selected:!0,children:[" ","\xa0\xa0 \xa0 \xa0\xa0 Yesterday \xa0 \xa0\xa0"," "]}),(0,m.jsxs)("option",{value:v.week,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Weekly\xa0 \xa0\xa0"," "]}),(0,m.jsxs)("option",{value:v.month,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Monthly \xa0 \xa0\xa0"," "]}),(0,m.jsxs)("option",{value:v.quarterly,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Quarterly \xa0 \xa0\xa0"," "]}),(0,m.jsxs)("option",{value:v.yearly,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Yearly \xa0 \xa0\xa0"," "]})]})}),"\xa0 \xa0 \xa0"," ",(0,m.jsxs)("div",{children:[" ",(0,m.jsxs)(l.Q_,{onClick:function(){const e="".concat(u,"/machine/admin_download_excel_user/?from_date=").concat(f(w),"&to_date=").concat(f(x)),a=new Headers({"x-api-key":t,Authorization:"Bearer ".concat(null===d||void 0===d?void 0:d.access)});console.log(null===d||void 0===d?void 0:d.access,"santosh");const n=new Request(e,{method:"GET",headers:a});fetch(n).then((e=>{if(e.ok)return console.log(e),e.blob();console.error("Request failed:",e.statusText)})).then((e=>{const t=window.URL.createObjectURL(e),a=document.createElement("a");a.style.display="none",a.href=t,a.download="User_Report"+f(new Date)+".xlsx",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(t)})).catch((e=>{console.error("Network error:",e)}))},type:"button",className:"btn btn-default btn-sm ",style:{backgroundColor:D,color:"white"},children:["Export Excel",(0,m.jsx)(r.A,{icon:i.n,style:{color:"White"},size:"sm"})]})," ",(0,m.jsxs)(l.Q_,{onClick:function(){var e="";e='<h2 style="font-size: 16px; text-align: center; color:red">User Machine Report</h2>'+'<p style="font-size: 12px; text-align: center;">'.concat(w," to ").concat(x,"</p> ")+'<table border="1" style="margin-left: auto;margin-right: auto;border-bottom: 1px solid #ddd; border-collapse: collapse; font-size: 14px;text-align: center; align: center; "><tr><th style="font-weight: bold;width:5%;text-align: center;">Sr.No.</th><th style="font-weight: bold;width:19%;text-align: center;">Name</th><th style="font-weight: bold;width:19%;text-align: center;">Email ID</th><th style="font-weight: bold;width:19%;text-align: center;">Mobile Number</th><th style="font-weight: bold;width:19%;text-align: center;">Machine ID</th><th style="font-weight: bold;width:19%;text-align: center;">Machine Assigned Date</th></tr>',g.map(((t,a)=>e+='<tr> \n        <td style="text-align: center;">'.concat(a+1,'</td>\n        <td style="text-align: center;">').concat(t.user_name,'</td>\n        <td style="text-align: center;">').concat(t.user_Id,'</td>\n        <td style="text-align: center;">').concat(t.mobile_no,'</td>\n        <td style="text-align: center;">').concat(t.machine_id,'</td>\n        <td style="text-align: center;">').concat(t.machine_assigned_date,"</td>\n    </tr>"))),e=(e+="</table>").replace(/<th/g,'<th align="left" ').replace(/<td/g,'<td align="left" ');var t=window.open("","","height=400,width=800");t.document.write(e),t.document.close(),setTimeout((function(){t.print()}),10)},type:"button",className:"btn btn-default btn-sm ",style:{backgroundColor:D,color:"white"},children:["Export pdf"," ",(0,m.jsx)(r.A,{icon:i.n,style:{color:"White"},size:"sm"})]})]})]}),(0,m.jsx)("div",{children:(0,m.jsx)(l.sK,{xm:{cols:12},children:(0,m.jsx)(l.UF,{xs:12,children:(0,m.jsx)(l.Pd,{activePage:1,clickableRows:!0,columns:[{key:"sr_no",label:"Sr. No.",sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"75px"}},{label:"Name",key:"user_name",sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"130px"}},{label:"Email / ID",key:"user_Id",sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"130px"}},{label:"Mobile Number",key:"mobile_no",sorter:!1,_props:{color:"secondary",className:"fw-semibold",align:"middle"},_style:{minWidth:"180px"}},{label:"Machine ID",key:"machine_id",sorter:!1,_props:{color:"secondary",className:"fw-semibold",align:"middle"},_style:{minWidth:"180px"}},{label:"Machine Assigned Date",key:"machine_assigned_date",sorter:!1,_props:{color:"secondary",className:"fw-semibold"},_style:{minWidth:"130px"}}],columnSorter:!0,items:g,itemsPerPageSelect:!0,itemsPerPage:10,pagination:!0,_props:{scope:"col",className:"align-middle"},scopedColumns:{sr_no:(e,t)=>(0,m.jsx)("td",{children:t+1}),created_at:e=>(0,m.jsx)("td",{children:b(e.created_at)})},itemsPerPageOptions:[10,20,50,100],tableProps:{color:"success-color-secondary",hover:!0,border:"1.5px solid #074",responsive:!0},tableHeadProps:{color:"light",align:"middle",className:"align-middle"},tableBodyProps:{align:"middle",className:"align-middle"},itemsPerPageLabel:"Rows per page:"})})})})]})})}}}]);