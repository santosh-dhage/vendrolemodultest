(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[3048],{13048:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var o=n(9950),r=n(1072),a=n(37017),l=n(45532),i=n(7864),s=n(76058),c=(n(46411),n(44885)),d=(n(59019),n(60764),n(42019),n(4434),n(74297)),u=n(95652),p=n(44414);const f=(0,d.A)();const y=function(){let e=(0,r.A)();const t=(0,u.A)(),{user:n,authTokens:d}=(0,o.useContext)(l.A);let[y,h]=(0,o.useState)([]),[g,m]=(0,o.useState)(T(new Date((new Date).setDate((new Date).getDate()-1)))),[b,w]=(0,o.useState)(T(new Date((new Date).setDate((new Date).getDate()))));const{selectedColor:v}=(0,c.useColor)();let[_,x]=(0,o.useState)(0),[k,D]=(0,o.useState)(0),[C,j]=(0,o.useState)(0),[O,S]=(0,o.useState)(0),[P,R]=(0,o.useState)(0),[A,E]=(0,o.useState)(0),[F,M]=(0,o.useState)(!1);function T(e){if(null!=e){var t=new Date(e),n=""+(t.getMonth()+1),o=""+t.getDate(),r=t.getFullYear();return n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),[r,n,o].join("-")}}(0,o.useEffect)((()=>{I()}),[]);const I=async t=>{var n=document.getElementById("datetodate1").selectedIndex;var o=document.getElementById("datetodate1").options[n].value.toString();m(o.split("=")[0]),w(o.split("=")[1]);let r=await e.post("/post_mis_report_for_customer_pdf/",{from_date:T(o.split("=")[0]),to_date:T(o.split("=")[1])});if(1===r.data.success){let e=[];for(let t=0;t<r.data.result.length;t++){let n=r.data.result[t];console.log(n);let o={spoc_id:null===n||void 0===n?void 0:n.spoc_id,name:null===n||void 0===n?void 0:n.name,mail:null===n||void 0===n?void 0:n.email,mobile:null===n||void 0===n?void 0:n.user_mobile_no,machine_id:null===n||void 0===n?void 0:n.machine_id,model_no:null===n||void 0===n?void 0:n.model_no,location:null===n||void 0===n?void 0:n.location,status:n.machine_status,count:n.current_inventory_count,product:null===n||void 0===n?void 0:n.product,date:null===n||void 0===n?void 0:n.date,time:null===n||void 0===n?void 0:n.time,type:null===n||void 0===n?void 0:n.type,amount:null===n||void 0===n?void 0:n.amount,success:null===n||void 0===n?void 0:n.success,refund_status:null===n||void 0===n?void 0:n.refund_status};e.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),e.push(o)}h([]),h(e)}else 0===r.data.success&&(h([]),alert(r.data.message))},N={today:T(new Date)+"="+T(new Date),yesterday:T(new Date((new Date).setDate((new Date).getDate()-1)))+"="+T(new Date((new Date).setDate((new Date).getDate()-1))),week:T(new Date((new Date).setDate((new Date).getDate()-6)))+"="+T(new Date(new Date)),month:T(new Date((new Date).setDate((new Date).getDate()-29)))+"="+T(new Date(new Date)),quarterly:T(new Date((new Date).setDate((new Date).getDate()-90)))+"="+T(new Date(new Date)),yearly:T(new Date((new Date).setDate((new Date).getDate()-365)))+"="+T(new Date(new Date))};return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[(0,p.jsx)("div",{children:(0,p.jsx)("h3",{className:"mb-0",style:{color:"#2C384A"},children:"Customer MIS Report"})})," ",(0,p.jsx)("div",{children:" "})]}),(0,p.jsxs)("div",{className:"input-group mt-2 mb-2",children:[(0,p.jsx)("div",{children:(0,p.jsxs)("select",{id:"datetodate1",onChange:I,style:{width:"150px",height:"25px"},children:[(0,p.jsxs)("option",{value:N.today,children:[" ","\xa0\xa0 \xa0 \xa0\xa0 Today \xa0 \xa0\xa0"," "]}),(0,p.jsxs)("option",{value:N.yesterday,selected:!0,children:[" ","\xa0\xa0 \xa0 \xa0\xa0 Yesterday \xa0 \xa0\xa0"," "]}),(0,p.jsxs)("option",{value:N.week,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Weekly\xa0 \xa0\xa0"," "]}),(0,p.jsxs)("option",{value:N.month,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Monthly \xa0 \xa0\xa0"," "]}),(0,p.jsxs)("option",{value:N.quarterly,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Quarterly \xa0 \xa0\xa0"," "]}),(0,p.jsxs)("option",{value:N.yearly,children:[" ","\xa0\xa0 \xa0 \xa0\xa0Yearly \xa0 \xa0\xa0"," "]})]})}),"\xa0 \xa0 \xa0"," ",(0,p.jsxs)("div",{children:[" ",(0,p.jsxs)(a.Q_,{onClick:function(){const e="".concat(f,"/generate_and_download_excel_report_for_customer/?from_date=").concat(T(g),"&to_date=").concat(T(b)),n=new Headers({"x-api-key":t,Authorization:"Bearer ".concat(null===d||void 0===d?void 0:d.access)});console.log(null===d||void 0===d?void 0:d.access,"santosh");const o=new Request(e,{method:"GET",headers:n});fetch(o).then((e=>{if(e.ok)return console.log(e),e.blob();console.error("Request failed:",e.statusText)})).then((e=>{const t=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=t,n.download="CustomerMIS_Report"+T(new Date)+".xlsx",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(t)})).catch((e=>{console.error("Network error:",e)}))},type:"button",className:"btn btn-default btn-sm",style:{backgroundColor:v,color:"white",height:"28px"},children:["Export Excel",(0,p.jsx)(i.A,{icon:s.n,style:{color:"White"},size:"sm"})]})," ",(0,p.jsxs)(a.Q_,{onClick:function(){var e="";e='<h2 style="font-size: 16px; text-align: center; color:red">Customer MIS Report</h2>'+'<p style="font-size: 12px; text-align: center;">'.concat(g," to ").concat(b,"</p> ")+'<div class="justify-content: center"><table  border="1" style="margin-left: auto;margin-right: auto;width:100%;border-bottom: 1px solid #ddd; border-collapse: collapse; font-size: 14px;text-align: center; align: center; border-color: #96D4D4;"><tr><td colspan="5" style="font-size: 18px; text-align: center; font-weight: bold;background-color: green;">CUSTOMER</td> <td colspan="5" style="font-size: 18px; text-align: center; font-weight: bold;background-color: #f8356f;color:white;">MACHINE</td><td colspan="7" style="font-size: 18px; text-align: center; font-weight: bold;background-color: yellow;">PRODUCT</td> </tr><tr><th style="font-weight: bold;width:2%; text-align: center;">Sr. No.</th><th style="font-weight: bold;width:5%;text-align: center;">SPOC ID</th><th style="font-weight: bold;width:5%;text-align: center;">NAME</th><th style="font-weight: bold;width:5%;text-align: center;">Mobile</th><th style="font-weight: bold;width:5%;text-align: center;">Email</th><th style="font-weight: bold;width:5%;text-align: center;">Machin ID</th><th style="font-weight: bold;width:5%;text-align: center;">Model No</th><th style="font-weight: bold;width:5%;text-align: center;">Location</th><th style="font-weight: bold;width:5%;text-align: center;">Current status ON/OFF</th><th style="font-weight: bold;width:5%;text-align: center;">Current Inventory Count</th><th style="font-weight: bold;width:5%;text-align: center;">Product</th><th style="font-weight: bold;width:5%;text-align: center;">Date</th><th style="font-weight: bold;width:5%;text-align: center;">Time</th><th style="font-weight: bold;width:5%;text-align: center;">Type</th><th style="font-weight: bold;width:5%;text-align: center;">Amount</th><th style="font-weight: bold;width:5%;text-align: center;">Success (Y/N)</th><th style="font-weight: bold;width:5%;text-align: center;">Refund Status</th></tr>',y.map(((t,n)=>e+='<tr> \n          <td style="text-align: center;">'.concat(n+1,'</td>\n          <td style="text-align: center;">').concat(t.spoc_id,'</td>\n          <td style="text-align: center;">').concat(t.name,'</td>\n          <td style="text-align: center;">').concat(t.mobile,'</td>\n          <td style="text-align: center;">').concat(t.mail,'</td>\n          <td style="text-align: center;">').concat(t.machine_id,'</td>\n          <td style="text-align: center;">').concat(t.model_no,'</td>\n          <td style="text-align: center;">').concat(t.location,'</td>\n          <td style="text-align: center;">').concat(t.status,'</td>\n          <td style="text-align: center;">').concat(t.count,'</td>\n          <td style="text-align: center;">').concat(t.product,'</td>\n          <td style="text-align: center;">').concat(t.date,'</td>\n          <td style="text-align: center;">').concat(t.time,'</td>\n          <td style="text-align: center;">').concat(t.type,'</td>\n          <td style="text-align: center;">').concat(t.amount,'</td>\n          <td style="text-align: center;">').concat(t.success,'</td>\n          <td style="text-align: center;">').concat(t.refund_status,"</td>\n      </tr>"))),e=(e+="</table></div>").replace(/<th/g,'<th align="left" ').replace(/<td/g,'<td align="left" ');var t=window.open("","","height=400,width=800");t.document.write(e),t.document.close(),setTimeout((function(){t.print()}),10)},type:"button",className:"btn btn-default btn-sm ",style:{backgroundColor:v,color:"white",height:"28px"},children:["Export  Pdf",(0,p.jsx)(i.A,{icon:s.n,style:{color:"White"},size:"sm"})]})]})]}),(0,p.jsx)("div",{children:(0,p.jsx)(a.sK,{xm:{cols:12},children:(0,p.jsx)(a.UF,{xs:12,children:(0,p.jsx)(a.Pd,{activePage:1,clickableRows:!0,columns:[{group:"CUSTOMER",_props:{colSpan:5,color:"green"},children:[{key:"sr_no",label:"Sr. No.",_props:{scope:"col"},sorter:!1,_style:{minWidth:"40px"}},{key:"spoc_id",label:"SPOC ID",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"name",label:"Name",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"mobile",label:"Mobile",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"mail",label:"Email",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}}]},{group:"MACHINE",_props:{colSpan:5,color:"red"},children:[{key:"machine_id",label:"Machine Id",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"model_no",label:"Model No",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"location",label:"Location",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"status",label:"Current status ON/OFF",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"count",label:"Current Inventory Count",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}}]},{group:"PRODUCT",_props:{colSpan:7,color:"yellow"},children:[{key:"product",label:"Product",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"date",lable:"Date",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"time",label:"Time",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"type",label:"Type",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"amount",label:"Amount",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"success",label:"Success (Y/N)",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}},{key:"refund_status",label:"Refund Status",_props:{scope:"col"},sorter:!1,_style:{minWidth:"100px"}}]}],items:y,itemsPerPageSelect:!0,itemsPerPage:10,pagination:!0,scopedColumns:{sr_no:(e,t)=>(0,p.jsx)("td",{children:t+1})},itemsPerPageOptions:[10,20,50,100],tableProps:{color:"success-color-secondary",hover:!0,bordered:!0,responsive:!0},tableHeadProps:{color:"light",align:"middle",className:"align-middle"},tableBodyProps:{align:"middle",className:"align-middle"},itemsPerPageLabel:"Rows per page:"})})})})]})})}},76058:(e,t,n)=>{"use strict";n.d(t,{n:()=>o});const o=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='367.997 338.75 271.999 434.747 271.999 17.503 239.999 17.503 239.999 434.745 144.003 338.75 121.376 361.377 256 496 390.624 361.377 367.997 338.75' class='ci-primary'/>"]},46411:(e,t,n)=>{e.exports=n(795)},91078:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(9950),l=(o=a)&&o.__esModule?o:{default:o},i=n(87924),s=n(8010);var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"buildURI",value:function(){return i.buildURI.apply(void 0,arguments)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.headers,o=e.separator,r=e.enclosingCharacter,a=e.uFEFF,l=e.target,i=e.specs,s=e.replace;this.state.page=window.open(this.buildURI(t,a,n,o,r),l,i,s)}},{key:"getWindow",value:function(){return this.state.page}},{key:"render",value:function(){return null}}]),t}(l.default.Component);c.defaultProps=Object.assign(s.defaultProps,{target:"_blank"}),c.propTypes=s.propTypes,t.default=c},49462:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(9950),i=(o=l)&&o.__esModule?o:{default:o},s=n(87924),c=n(8010);var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildURI=n.buildURI.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"buildURI",value:function(){return s.buildURI.apply(void 0,arguments)}},{key:"handleLegacy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(window.navigator.msSaveOrOpenBlob){e.preventDefault();var n=this.props,o=n.data,r=n.headers,a=n.separator,l=n.filename,i=n.enclosingCharacter,c=n.uFEFF,d=t&&"function"===typeof o?o():o,u=new Blob([c?"\ufeff":"",(0,s.toCSV)(d,r,a,i)]);return window.navigator.msSaveBlob(u,l),!1}}},{key:"handleAsyncClick",value:function(e){var t=this;this.props.onClick(e,(function(n){!1!==n?t.handleLegacy(e,!0):e.preventDefault()}))}},{key:"handleSyncClick",value:function(e){!1===this.props.onClick(e)?e.preventDefault():this.handleLegacy(e)}},{key:"handleClick",value:function(){var e=this;return function(t){if("function"===typeof e.props.onClick)return e.props.asyncOnClick?e.handleAsyncClick(t):e.handleSyncClick(t);e.handleLegacy(t)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,o=t.headers,a=t.separator,l=t.filename,s=t.uFEFF,c=t.children,d=(t.onClick,t.asyncOnClick,t.enclosingCharacter),u=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(t,["data","headers","separator","filename","uFEFF","children","onClick","asyncOnClick","enclosingCharacter"]),p="undefined"===typeof window?"":this.buildURI(n,s,o,a,d);return i.default.createElement("a",r({download:l},u,{ref:function(t){return e.link=t},target:"_self",href:p,onClick:this.handleClick()}),c)}}]),t}(i.default.Component);d.defaultProps=c.defaultProps,d.propTypes=c.propTypes,t.default=d},87924:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r=t.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},a=t.isJsons=function(e){return Array.isArray(e)&&e.every((function(e){return"object"===("undefined"===typeof e?"undefined":n(e))&&!(e instanceof Array)}))},l=t.isArrays=function(e){return Array.isArray(e)&&e.every((function(e){return Array.isArray(e)}))},i=t.jsonsHeaders=function(e){return Array.from(e.map((function(e){return Object.keys(e)})).reduce((function(e,t){return new Set([].concat(o(e),o(t)))}),[]))},s=t.jsons2arrays=function(e,t){var n=t=t||i(e),r=t;a(t)&&(n=t.map((function(e){return e.label})),r=t.map((function(e){return e.key})));var l=e.map((function(e){return r.map((function(t){return c(t,e)}))}));return[n].concat(o(l))},c=t.getHeaderValue=function(e,t){var n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce((function(e,t,n,o){var r=e[t];if(void 0!==r&&null!==r)return r;o.splice(1)}),t);return void 0===n?e in t?t[e]:"":n},d=t.elementOrEmpty=function(e){return"undefined"===typeof e||null===e?"":e},u=t.joiner=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'"';return e.filter((function(e){return e})).map((function(e){return e.map((function(e){return d(e)})).map((function(e){return""+n+e+n})).join(t)})).join("\n")},p=t.arrays2csv=function(e,t,n,r){return u(t?[t].concat(o(e)):e,n,r)},f=t.jsons2csv=function(e,t,n,o){return u(s(e,t),n,o)},y=t.string2csv=function(e,t,n,o){return t?t.join(n)+"\n"+e:e.replace(/"/g,'""')},h=t.toCSV=function(e,t,n,o){if(a(e))return f(e,t,n,o);if(l(e))return p(e,t,n,o);if("string"===typeof e)return y(e,t,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')};t.buildURI=function(e,t,n,o,a){var l=h(e,n,o,a),i=r()?"application/csv":"text/csv",s=new Blob([t?"\ufeff":"",l],{type:i}),c="data:"+i+";charset=utf-8,"+(t?"\ufeff":"")+l,d=window.URL||window.webkitURL;return"undefined"===typeof d.createObjectURL?c:d.createObjectURL(s)}},795:(e,t,n)=>{"use strict";t.CSVLink=void 0;var o=a(n(91078)),r=a(n(49462));function a(e){return e&&e.__esModule?e:{default:e}}o.default,t.CSVLink=r.default},8010:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropsNotForwarded=t.defaultProps=t.propTypes=void 0;var o,r=n(9950),a=((o=r)&&o.__esModule,n(11942));t.propTypes={data:(0,a.oneOfType)([a.string,a.array,a.func]).isRequired,headers:a.array,target:a.string,separator:a.string,filename:a.string,uFEFF:a.bool,onClick:a.func,asyncOnClick:a.bool,enclosingCharacter:a.string},t.defaultProps={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},t.PropsNotForwarded=["data","headers"]},4434:()=>{},42019:()=>{}}]);